<!DOCTYPE html>
<html>
<head lang="zh-cn">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="viewport"
			content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
	<title>Amaze UI React</title>
	<meta name="renderer" content="webkit">
	<!-- No Baidu Siteapp-->
	<meta http-equiv="Cache-Control" content="no-siteapp"/>
	<link rel="alternate icon" type="image/png" href="i/favicon.png">
	<link rel="apple-touch-icon-precomposed" href="i/app-icon72x72@2x.png">
	<meta name="apple-mobile-web-app-title" content="AMUI React"/>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link rel="stylesheet" href="http://cdn.amazeui.org/amazeui/2.4.0/css/amazeui.min.css"/>
	<script src="js/dependencies/react.min.js"></script>
	<script src="js/dependencies/browser.min.js"></script>
	<script src="http://cdn.amazeui.org/amazeui-react/1.0.0-beta1/amazeui.react.js"></script>
	<script src="js/dependencies/pubsub.js"></script>	
</head>
<body>
    <div id="main"></div>
	
<script type="text/babel">
var PHONE_SCREEN_WIDTH = 480;
var PAD_SCREEN_WIDTH = 960;
var MIDDLE_PC_SCREEN_WIDTH = 1366;

var Header = AMUIReact.Header;
var Image = AMUIReact.Image;
var ButtonToolbar = AMUIReact.ButtonToolbar;
var ButtonGroup = AMUIReact.ButtonGroup;
var Button = AMUIReact.Button;

var SystemMessage = React.createClass({
	render: function() {
		var messageContainerStyle = {
			'text-align': 'center',
			'color': 'darkseagreen',
			'margin-top': 5,
			'margin-bottom': 5,
		};
		return (
			<div style={messageContainerStyle}>
				<span>一一一一一 {this.props.message} 一一一一一</span>
			</div>
		);
	}
});
var Message = React.createClass({
	getDefaultProps: function() {
		return {
			align: 'left',
		};
	},
	
	render: function() {
		var messageStyle = {
			'margin-left': 20,
			'margin-right': 20,
			'padding-top': '0px',
			'overflow': 'hidden',
		};
		var avatarContainerStyle = {
			'float': this.props.align,
			'margin': 10,
		};
		var avatarStyle = {
			'width': 40,
			'height': 40,
		};
		var messageInfoContainerStyle = {
			'margin-left': 60,
			'color': 'snow',
			'text-align': this.props.align,
		};
		var timeStyle = {
			'margin-left': '10px',
    		'font-size': '14px',
		};
		var messageContentContainerStyle = {
			'margin': '0px 0px 0px auto',
			'background-color': 'rgba(230,230,230,0.8)',
			'word-brea': 'normal',
   	 		'word-wrap': 'break-word',
			'padding': '0px 10px',
			'border-radius': '10px',
			'display': 'inline-block',
			'float': this.props.align,
			'max-width': this.props.width - (messageStyle['margin-left'] + avatarContainerStyle['margin'] * 2 + avatarStyle['width']) * 2,
		};
		
		return (
			<div style={messageStyle}>
				<div style={avatarContainerStyle}>
					<Image src={this.props.avatar} style={avatarStyle} circle></Image>
				</div>
				<div style={messageInfoContainerStyle}>
					<span>{this.props.nickname}</span>
					<span style={timeStyle}>{this.props.time}</span>
				</div>
				<div style={messageContentContainerStyle}>
					<span>{this.props.message}</span>
				</div>
			</div>
		);
	}
});

//表情选择组件
var ExpressionSelectForm = React.createClass({
	getDefaultProps: function() {
		return {
			show: false,
		};
	},
	//处理表情选择事件
	handleClick: function(event) {
		console.log(event.nativeEvent.target.currentSrc);
	},
	render: function() {
		var expressionContainerStyle = {
			'width': 511,
			'height': 256,
			'background-color': 'white',
			'position': 'absolute',
			'left': this.props.left,
			'bottom': this.props.bottom,
		};
		if (this.props.show) {
			expressionContainerStyle['display'] = 'block';
		}
		else {
			expressionContainerStyle['display'] = 'none';
		}
		
		var tdStyle = {
			'width': 50,
			'height': 50,
			'border-collapse': 'collapse',
			'border': 'solid 1px #e3e3e3',
		};
		var imgStyle = {
			'width': 30,
			'height': 30,
			'margin': 10,
		};
		
		return (
			<div style={expressionContainerStyle}>
				<table>
					<tr>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/1.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/2.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/3.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/4.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/5.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/6.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/7.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/8.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/9.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/10.png"></img></td>
					</tr>
					<tr>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/11.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/12.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/13.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/14.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/15.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/16.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/17.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/18.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/19.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/20.png"></img></td>
					</tr>
					<tr>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/21.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/22.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/23.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/24.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/25.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/26.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/27.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/28.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/29.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/30.png"></img></td>
					</tr>
					<tr>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/31.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/32.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/33.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/34.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/35.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/36.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/37.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/38.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/39.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/40.png"></img></td>
					</tr>
					<tr>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/41.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/42.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/43.png"></img></td>
						<td style={tdStyle} onClick={this.handleClick}><img style={imgStyle} src="images/expression/44.png"></img></td>
						<td style={tdStyle}></td>
						<td style={tdStyle}></td>
						<td style={tdStyle}></td>
						<td style={tdStyle}></td>
						<td style={tdStyle}></td>
						<td style={tdStyle}></td>
					</tr>
				</table>
			</div>
		);
	}
});
var ToolbarForm = React.createClass({
	handleExpressionClick: function(event) {
		PubSub.publishSync('expression-button-click', event);
	},
	render: function() {
		var groupStyle = {
			'height': this.props.height,
		};
		var buttonStyle = {
			'width': this.props.height,
			'height': this.props.height,
			'background-color': 'rgba(0,0,0,0)',
			'border-width': 0,
			'padding': 0,
		};
		return (
			<div style={groupStyle}>
				<button style={buttonStyle} onClick={this.handleExpressionClick}><img src="images/toolbar-expression.png"></img></button>
			</div>
		);
	}
});
var InputForm = React.createClass({
	render: function() {
		var textareaContainerStyle = {
			'width': this.props.width,
			'height': this.props.height,
		};
		var textareaStyle = {
			'width': this.props.width,
			'height': this.props.height,
			'background-color': 'rgba(0,0,0,0.5)',
			'border-bottom-left-radius': 10,
    		'border-bottom-right-radius': 10,
			'color': 'snow',
			'padding': 10,
			'font-size': 14,
		};
		return (
			<div style={textareaContainerStyle}>
				<textarea style={textareaStyle} placeholder="请输入消息"></textarea>
			</div>
		);
	}
});
var HeadForm = React.createClass({
	render: function() {
		var pcHeadStyle = {
			'height': this.props.height,
			'background-color': 'black',
		};
		var pcHeadElementContainerStyle = {
			'height': this.props.height,
			'max-width': 1366 * 0.618,
			'margin': '0 auto',
		};
		var productInfoStyle = {
			'font-size': 30,
			'margin-left': 50,
			'color': 'snow',
		};
		var userInfoStyle = {
			'font-size': 16,
			'margin-right': 50,
			'float': 'right',
			'color': 'snow',
			'margin-top': 20,
		};
		
		
		return (
			<div>
				<div style={pcHeadStyle}>
					<div style={pcHeadElementContainerStyle}>
						<span style={productInfoStyle}>轻聊</span>
						<span style={userInfoStyle}>碎碎酱</span>
					</div>
				</div>
			</div>
		);
	}
});

var BodyForm = React.createClass({
	getDefaultProps: function() {
		return {
			toolbarFormHeight: 30,
			inputFormHeight: 80,
		};
	},
	getInitialState: function() {
		return {
			showExpressionForm: false,
		};
	},
	componentDidMount: function() {
		var elementReference = this;
		var expressionButtonClickEvent = PubSub.subscribe('expression-button-click', function(event, data) {
			elementReference.setState({
				showExpressionForm: !elementReference.state.showExpressionForm,
			});
		});
	},
	componentWillUnmount: function() {
		
	},
	render: function() {
		var bodyStyle = {
			'width': this.props.width,
			'height': this.props.height,
			'background-image': 'url("images/react-background.png")',
		};
		var chatFormStyle = {
			'max-width': 1366 * 0.618,
			'height': this.props.height,
			'margin': '0px auto',
			'background-color': 'rgba(0,0,0,0.5)',
			'border-bottom-left-radius': 10,
    		'border-bottom-right-radius': 10,
		};
		var messageFormStyle = {
			'height': this.props.height - this.props.toolbarFormHeight - this.props.inputFormHeight,
			'overflow': 'auto',
		};
		var toolbarFormStyle = {
			'height': this.props.toolbarFormHeight,
			'background-color': 'rgba(153,153,153,0.5)',
		};
		var realMessageFormWidth = (this.props.width < chatFormStyle['max-width'] ? this.props.width : chatFormStyle['max-width']);
		
		return (
			<div style={bodyStyle}>
				<div style={chatFormStyle}>
					<div style={messageFormStyle}>
						<Message avatar="images/head.png" nickname="碎碎酱" time="11:11:11" message="大家好，我是新人。" align="left" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="管理员" time="11:11:11" message="你好，欢迎你。" align="right" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="碎碎酱" time="11:11:11" message="你好，欢迎你。放假啊离开圣诞节发了卡是假的离开房间啊看来是大家发了卡就撒大连开发机上课了大家发了卡就撒大连开发机阿斯利康的积分" align="left" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="碎碎酱" time="11:11:11" message="咳咳。333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333" width={realMessageFormWidth}></Message>
						<SystemMessage message="12:12:12 碎碎酱进入房间"></SystemMessage>
						<Message avatar="images/head.png" nickname="碎碎酱" time="11:11:11" message="大家好，我是新人。" align="left" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="管理员" time="11:11:11" message="你好，欢迎你。" align="right" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="碎碎酱" time="11:11:11" message="大家好，我是新人。" align="left" width={realMessageFormWidth}></Message>
						<Message avatar="images/head.png" nickname="管理员" time="11:11:11" message="你好，欢迎你。" align="right" width={realMessageFormWidth}></Message>
					</div>
					<div style={toolbarFormStyle}>
						<ToolbarForm height={this.props.toolbarFormHeight}></ToolbarForm>
					</div>
					<InputForm width={realMessageFormWidth} height={this.props.inputFormHeight}></InputForm>
					<ExpressionSelectForm left={(this.props.width - realMessageFormWidth) / 2} bottom={this.props.toolbarFormHeight + this.props.inputFormHeight} show={this.state.showExpressionForm}></ExpressionSelectForm>
				</div>
			</div>
		);
	}
});

var MainForm = React.createClass({
	getDefaultProps: function() {
		return {

		};
	},
	
	getInitialState: function() {
		return {
			viewport: {
				width: window.innerWidth,
				height: window.innerHeight
			}
		};
	},
	
	handleViewPortResize: function() {
		this.setState({
			viewport: {
				width: window.innerWidth,
				height: window.innerHeight
			}
		});
	},
	
	componentDidMount: function() {
		window.addEventListener('resize', this.handleViewPortResize);
	},
	
	componentWillUnmount: function() {
		window.removeEventListener('resize', this.handleViewPortResize);
	},
	
	render: function() {
		var mainFormStyle = {
			'width': this.state.viewport.width,
			'height': this.state.viewport.height,
		};
		var headFormHeight = 50;
		return (
			<div style={mainFormStyle}>
				<HeadForm width={this.state.viewport.width} height={headFormHeight}/>
				<BodyForm width={this.state.viewport.width} height = {this.state.viewport.height - headFormHeight}/>
			</div>
		);
	}
});

React.render(<MainForm />, document.getElementById('main'));
</script>
</body>
</html>